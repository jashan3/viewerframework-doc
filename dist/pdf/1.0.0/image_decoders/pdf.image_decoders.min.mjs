var t={d:(e,n)=>{for(var s in n)t.o(n,s)&&!t.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:n[s]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)},e=globalThis.pdfjsImageDecoders={};t.d(e,{Jbig2Error:()=>D,Jbig2Image:()=>st,JpegError:()=>it,JpegImage:()=>vt,JpxError:()=>_t,JpxImage:()=>Tt,VerbosityLevel:()=>n,getVerbosityLevel:()=>r,setVerbosityLevel:()=>i}),"object"!=typeof process||process+""!="[object process]"||process.versions.nw||process.versions.electron&&process.type&&process.type;const n={ERRORS:0,WARNINGS:1,INFOS:5};let s=n.WARNINGS;function i(t){Number.isInteger(t)&&(s=t)}function r(){return s}function o(t){n.INFOS}function a(t){n.WARNINGS}function c(t){throw new Error(t)}function l(t,e,n,s=!1){return Object.defineProperty(t,e,{value:n,enumerable:!s,configurable:!0,writable:!1}),n}const h=function(){function t(t,e){this.message=t,this.name=e}return t.prototype=new Error,t.constructor=t,t}();class f extends h{constructor(t){super(t,"FormatError")}}class u{static get isLittleEndian(){return l(this,"isLittleEndian",function(){const t=new Uint8Array(4);return t[0]=1,1===new Uint32Array(t.buffer,0,1)[0]}())}static get isEvalSupported(){return l(this,"isEvalSupported",function(){try{return new Function(""),!0}catch{return!1}}())}static get isOffscreenCanvasSupported(){return l(this,"isOffscreenCanvasSupported","undefined"!=typeof OffscreenCanvas)}static get isImageDecoderSupported(){return l(this,"isImageDecoderSupported","undefined"!=typeof ImageDecoder)}static get platform(){if("undefined"!=typeof navigator&&"string"==typeof navigator?.platform&&"string"==typeof navigator?.userAgent){const{platform:t,userAgent:e}=navigator;return l(this,"platform",{isAndroid:e.includes("Android"),isLinux:t.includes("Linux"),isMac:t.includes("Mac"),isWindows:t.includes("Win"),isFirefox:e.includes("Firefox")})}return l(this,"platform",{isAndroid:!1,isLinux:!1,isMac:!1,isWindows:!1,isFirefox:!1})}static get isCSSRoundSupported(){return l(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}}Array.from(Array(256).keys(),(t=>t.toString(16).padStart(2,"0"))),"function"!=typeof Promise.try&&(Promise.try=function(t,...e){return new Promise((n=>{n(t(...e))}))}),Symbol("CIRCULAR_REF"),Symbol("EOF"),Object.create(null),Object.create(null),Object.create(null),Symbol.iterator,Symbol.iterator,Symbol.iterator;class d{get length(){c("Abstract getter `length` accessed")}get isEmpty(){c("Abstract getter `isEmpty` accessed")}get isDataLoaded(){return l(this,"isDataLoaded",!0)}getByte(){c("Abstract method `getByte` called")}getBytes(t){c("Abstract method `getBytes` called")}async getImageData(t,e){return this.getBytes(t,e)}async asyncGetBytes(){c("Abstract method `asyncGetBytes` called")}get isAsync(){return!1}get isAsyncDecoder(){return!1}get canAsyncDecodeImageFromBuffer(){return!1}async getTransferableImage(){return null}peekByte(){const t=this.getByte();return-1!==t&&this.pos--,t}peekBytes(t){const e=this.getBytes(t);return this.pos-=e.length,e}getUint16(){const t=this.getByte(),e=this.getByte();return-1===t||-1===e?-1:(t<<8)+e}getInt32(){return(this.getByte()<<24)+(this.getByte()<<16)+(this.getByte()<<8)+this.getByte()}getByteRange(t,e){c("Abstract method `getByteRange` called")}getString(t){return function(t){"object"==typeof t&&void 0!==t?.length||c("Invalid argument for bytesToString");const e=t.length,n=8192;if(e<n)return String.fromCharCode.apply(null,t);const s=[];for(let i=0;i<e;i+=n){const r=Math.min(i+n,e),o=t.subarray(i,r);s.push(String.fromCharCode.apply(null,o))}return s.join("")}(this.getBytes(t))}skip(t){this.pos+=t||1}reset(){c("Abstract method `reset` called")}moveStart(){c("Abstract method `moveStart` called")}makeSubStream(t,e,n=null){c("Abstract method `makeSubStream` called")}getBaseStreams(){return null}}function m(t){return t>0?Math.ceil(Math.log2(t)):0}function g(t,e){return t[e]<<24>>24}function p(t,e){return t[e]<<8|t[e+1]}function w(t,e){return(t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3])>>>0}const b=[{qe:22017,nmps:1,nlps:1,switchFlag:1},{qe:13313,nmps:2,nlps:6,switchFlag:0},{qe:6145,nmps:3,nlps:9,switchFlag:0},{qe:2753,nmps:4,nlps:12,switchFlag:0},{qe:1313,nmps:5,nlps:29,switchFlag:0},{qe:545,nmps:38,nlps:33,switchFlag:0},{qe:22017,nmps:7,nlps:6,switchFlag:1},{qe:21505,nmps:8,nlps:14,switchFlag:0},{qe:18433,nmps:9,nlps:14,switchFlag:0},{qe:14337,nmps:10,nlps:14,switchFlag:0},{qe:12289,nmps:11,nlps:17,switchFlag:0},{qe:9217,nmps:12,nlps:18,switchFlag:0},{qe:7169,nmps:13,nlps:20,switchFlag:0},{qe:5633,nmps:29,nlps:21,switchFlag:0},{qe:22017,nmps:15,nlps:14,switchFlag:1},{qe:21505,nmps:16,nlps:14,switchFlag:0},{qe:20737,nmps:17,nlps:15,switchFlag:0},{qe:18433,nmps:18,nlps:16,switchFlag:0},{qe:14337,nmps:19,nlps:17,switchFlag:0},{qe:13313,nmps:20,nlps:18,switchFlag:0},{qe:12289,nmps:21,nlps:19,switchFlag:0},{qe:10241,nmps:22,nlps:19,switchFlag:0},{qe:9217,nmps:23,nlps:20,switchFlag:0},{qe:8705,nmps:24,nlps:21,switchFlag:0},{qe:7169,nmps:25,nlps:22,switchFlag:0},{qe:6145,nmps:26,nlps:23,switchFlag:0},{qe:5633,nmps:27,nlps:24,switchFlag:0},{qe:5121,nmps:28,nlps:25,switchFlag:0},{qe:4609,nmps:29,nlps:26,switchFlag:0},{qe:4353,nmps:30,nlps:27,switchFlag:0},{qe:2753,nmps:31,nlps:28,switchFlag:0},{qe:2497,nmps:32,nlps:29,switchFlag:0},{qe:2209,nmps:33,nlps:30,switchFlag:0},{qe:1313,nmps:34,nlps:31,switchFlag:0},{qe:1089,nmps:35,nlps:32,switchFlag:0},{qe:673,nmps:36,nlps:33,switchFlag:0},{qe:545,nmps:37,nlps:34,switchFlag:0},{qe:321,nmps:38,nlps:35,switchFlag:0},{qe:273,nmps:39,nlps:36,switchFlag:0},{qe:133,nmps:40,nlps:37,switchFlag:0},{qe:73,nmps:41,nlps:38,switchFlag:0},{qe:37,nmps:42,nlps:39,switchFlag:0},{qe:21,nmps:43,nlps:40,switchFlag:0},{qe:9,nmps:44,nlps:41,switchFlag:0},{qe:5,nmps:45,nlps:42,switchFlag:0},{qe:1,nmps:45,nlps:43,switchFlag:0},{qe:22017,nmps:46,nlps:46,switchFlag:0}];class y{constructor(t,e,n){this.data=t,this.bp=e,this.dataEnd=n,this.chigh=t[e],this.clow=0,this.byteIn(),this.chigh=this.chigh<<7&65535|this.clow>>9&127,this.clow=this.clow<<7&65535,this.ct-=7,this.a=32768}byteIn(){const t=this.data;let e=this.bp;255===t[e]?t[e+1]>143?(this.clow+=65280,this.ct=8):(e++,this.clow+=t[e]<<9,this.ct=7,this.bp=e):(e++,this.clow+=e<this.dataEnd?t[e]<<8:65280,this.ct=8,this.bp=e),this.clow>65535&&(this.chigh+=this.clow>>16,this.clow&=65535)}readBit(t,e){let n=t[e]>>1,s=1&t[e];const i=b[n],r=i.qe;let o,a=this.a-r;if(this.chigh<r)a<r?(a=r,o=s,n=i.nmps):(a=r,o=1^s,1===i.switchFlag&&(s=o),n=i.nlps);else{if(this.chigh-=r,32768&a)return this.a=a,s;a<r?(o=1^s,1===i.switchFlag&&(s=o),n=i.nlps):(o=s,n=i.nmps)}do{0===this.ct&&this.byteIn(),a<<=1,this.chigh=this.chigh<<1&65535|this.clow>>15&1,this.clow=this.clow<<1&65535,this.ct--}while(!(32768&a));return this.a=a,t[e]=n<<1|s,o}}const x=-1,k=[[-1,-1],[-1,-1],[7,8],[7,7],[6,6],[6,6],[6,5],[6,5],[4,0],[4,0],[4,0],[4,0],[4,0],[4,0],[4,0],[4,0],[3,1],[3,1],[3,1],[3,1],[3,1],[3,1],[3,1],[3,1],[3,1],[3,1],[3,1],[3,1],[3,1],[3,1],[3,1],[3,1],[3,4],[3,4],[3,4],[3,4],[3,4],[3,4],[3,4],[3,4],[3,4],[3,4],[3,4],[3,4],[3,4],[3,4],[3,4],[3,4],[3,3],[3,3],[3,3],[3,3],[3,3],[3,3],[3,3],[3,3],[3,3],[3,3],[3,3],[3,3],[3,3],[3,3],[3,3],[3,3],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2]],B=[[-1,-1],[12,-2],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[11,1792],[11,1792],[12,1984],[12,2048],[12,2112],[12,2176],[12,2240],[12,2304],[11,1856],[11,1856],[11,1920],[11,1920],[12,2368],[12,2432],[12,2496],[12,2560]],A=[[-1,-1],[-1,-1],[-1,-1],[-1,-1],[8,29],[8,29],[8,30],[8,30],[8,45],[8,45],[8,46],[8,46],[7,22],[7,22],[7,22],[7,22],[7,23],[7,23],[7,23],[7,23],[8,47],[8,47],[8,48],[8,48],[6,13],[6,13],[6,13],[6,13],[6,13],[6,13],[6,13],[6,13],[7,20],[7,20],[7,20],[7,20],[8,33],[8,33],[8,34],[8,34],[8,35],[8,35],[8,36],[8,36],[8,37],[8,37],[8,38],[8,38],[7,19],[7,19],[7,19],[7,19],[8,31],[8,31],[8,32],[8,32],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,12],[6,12],[6,12],[6,12],[6,12],[6,12],[6,12],[6,12],[8,53],[8,53],[8,54],[8,54],[7,26],[7,26],[7,26],[7,26],[8,39],[8,39],[8,40],[8,40],[8,41],[8,41],[8,42],[8,42],[8,43],[8,43],[8,44],[8,44],[7,21],[7,21],[7,21],[7,21],[7,28],[7,28],[7,28],[7,28],[8,61],[8,61],[8,62],[8,62],[8,63],[8,63],[8,0],[8,0],[8,320],[8,320],[8,384],[8,384],[5,10],[5,10],[5,10],[5,10],[5,10],[5,10],[5,10],[5,10],[5,10],[5,10],[5,10],[5,10],[5,10],[5,10],[5,10],[5,10],[5,11],[5,11],[5,11],[5,11],[5,11],[5,11],[5,11],[5,11],[5,11],[5,11],[5,11],[5,11],[5,11],[5,11],[5,11],[5,11],[7,27],[7,27],[7,27],[7,27],[8,59],[8,59],[8,60],[8,60],[9,1472],[9,1536],[9,1600],[9,1728],[7,18],[7,18],[7,18],[7,18],[7,24],[7,24],[7,24],[7,24],[8,49],[8,49],[8,50],[8,50],[8,51],[8,51],[8,52],[8,52],[7,25],[7,25],[7,25],[7,25],[8,55],[8,55],[8,56],[8,56],[8,57],[8,57],[8,58],[8,58],[6,192],[6,192],[6,192],[6,192],[6,192],[6,192],[6,192],[6,192],[6,1664],[6,1664],[6,1664],[6,1664],[6,1664],[6,1664],[6,1664],[6,1664],[8,448],[8,448],[8,512],[8,512],[9,704],[9,768],[8,640],[8,640],[8,576],[8,576],[9,832],[9,896],[9,960],[9,1024],[9,1088],[9,1152],[9,1216],[9,1280],[9,1344],[9,1408],[7,256],[7,256],[7,256],[7,256],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[5,128],[5,128],[5,128],[5,128],[5,128],[5,128],[5,128],[5,128],[5,128],[5,128],[5,128],[5,128],[5,128],[5,128],[5,128],[5,128],[5,8],[5,8],[5,8],[5,8],[5,8],[5,8],[5,8],[5,8],[5,8],[5,8],[5,8],[5,8],[5,8],[5,8],[5,8],[5,8],[5,9],[5,9],[5,9],[5,9],[5,9],[5,9],[5,9],[5,9],[5,9],[5,9],[5,9],[5,9],[5,9],[5,9],[5,9],[5,9],[6,16],[6,16],[6,16],[6,16],[6,16],[6,16],[6,16],[6,16],[6,17],[6,17],[6,17],[6,17],[6,17],[6,17],[6,17],[6,17],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[6,14],[6,14],[6,14],[6,14],[6,14],[6,14],[6,14],[6,14],[6,15],[6,15],[6,15],[6,15],[6,15],[6,15],[6,15],[6,15],[5,64],[5,64],[5,64],[5,64],[5,64],[5,64],[5,64],[5,64],[5,64],[5,64],[5,64],[5,64],[5,64],[5,64],[5,64],[5,64],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7]],I=[[-1,-1],[-1,-1],[12,-2],[12,-2],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[11,1792],[11,1792],[11,1792],[11,1792],[12,1984],[12,1984],[12,2048],[12,2048],[12,2112],[12,2112],[12,2176],[12,2176],[12,2240],[12,2240],[12,2304],[12,2304],[11,1856],[11,1856],[11,1856],[11,1856],[11,1920],[11,1920],[11,1920],[11,1920],[12,2368],[12,2368],[12,2432],[12,2432],[12,2496],[12,2496],[12,2560],[12,2560],[10,18],[10,18],[10,18],[10,18],[10,18],[10,18],[10,18],[10,18],[12,52],[12,52],[13,640],[13,704],[13,768],[13,832],[12,55],[12,55],[12,56],[12,56],[13,1280],[13,1344],[13,1408],[13,1472],[12,59],[12,59],[12,60],[12,60],[13,1536],[13,1600],[11,24],[11,24],[11,24],[11,24],[11,25],[11,25],[11,25],[11,25],[13,1664],[13,1728],[12,320],[12,320],[12,384],[12,384],[12,448],[12,448],[13,512],[13,576],[12,53],[12,53],[12,54],[12,54],[13,896],[13,960],[13,1024],[13,1088],[13,1152],[13,1216],[10,64],[10,64],[10,64],[10,64],[10,64],[10,64],[10,64],[10,64]],v=[[8,13],[8,13],[8,13],[8,13],[8,13],[8,13],[8,13],[8,13],[8,13],[8,13],[8,13],[8,13],[8,13],[8,13],[8,13],[8,13],[11,23],[11,23],[12,50],[12,51],[12,44],[12,45],[12,46],[12,47],[12,57],[12,58],[12,61],[12,256],[10,16],[10,16],[10,16],[10,16],[10,17],[10,17],[10,17],[10,17],[12,48],[12,49],[12,62],[12,63],[12,30],[12,31],[12,32],[12,33],[12,40],[12,41],[11,22],[11,22],[8,14],[8,14],[8,14],[8,14],[8,14],[8,14],[8,14],[8,14],[8,14],[8,14],[8,14],[8,14],[8,14],[8,14],[8,14],[8,14],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[9,15],[9,15],[9,15],[9,15],[9,15],[9,15],[9,15],[9,15],[12,128],[12,192],[12,26],[12,27],[12,28],[12,29],[11,19],[11,19],[11,20],[11,20],[12,34],[12,35],[12,36],[12,37],[12,38],[12,39],[11,21],[11,21],[12,42],[12,43],[10,0],[10,0],[10,0],[10,0],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12]],P=[[-1,-1],[-1,-1],[-1,-1],[-1,-1],[6,9],[6,8],[5,7],[5,7],[4,6],[4,6],[4,6],[4,6],[4,5],[4,5],[4,5],[4,5],[3,1],[3,1],[3,1],[3,1],[3,1],[3,1],[3,1],[3,1],[3,4],[3,4],[3,4],[3,4],[3,4],[3,4],[3,4],[3,4],[2,3],[2,3],[2,3],[2,3],[2,3],[2,3],[2,3],[2,3],[2,3],[2,3],[2,3],[2,3],[2,3],[2,3],[2,3],[2,3],[2,2],[2,2],[2,2],[2,2],[2,2],[2,2],[2,2],[2,2],[2,2],[2,2],[2,2],[2,2],[2,2],[2,2],[2,2],[2,2]];class C{constructor(t,e={}){if("function"!=typeof t?.next)throw new Error('CCITTFaxDecoder - invalid "source" parameter.');let n;for(this.source=t,this.eof=!1,this.encoding=e.K||0,this.eoline=e.EndOfLine||!1,this.byteAlign=e.EncodedByteAlign||!1,this.columns=e.Columns||1728,this.rows=e.Rows||0,this.eoblock=e.EndOfBlock??!0,this.black=e.BlackIs1||!1,this.codingLine=new Uint32Array(this.columns+1),this.refLine=new Uint32Array(this.columns+2),this.codingLine[0]=this.columns,this.codingPos=0,this.row=0,this.nextLine2D=this.encoding<0,this.inputBits=0,this.inputBuf=0,this.outputBits=0,this.rowsDone=!1;0===(n=this._lookBits(12));)this._eatBits(1);1===n&&this._eatBits(12),this.encoding>0&&(this.nextLine2D=!this._lookBits(1),this._eatBits(1))}readNextChar(){if(this.eof)return-1;const t=this.refLine,e=this.codingLine,n=this.columns;let s,i,r,a,c;if(0===this.outputBits){if(this.rowsDone&&(this.eof=!0),this.eof)return-1;let r,c,l;if(this.err=!1,this.nextLine2D){for(a=0;e[a]<n;++a)t[a]=e[a];for(t[a++]=n,t[a]=n,e[0]=0,this.codingPos=0,s=0,i=0;e[this.codingPos]<n;)switch(r=this._getTwoDimCode(),r){case 0:this._addPixels(t[s+1],i),t[s+1]<n&&(s+=2);break;case 1:if(r=c=0,i){do{r+=l=this._getBlackCode()}while(l>=64);do{c+=l=this._getWhiteCode()}while(l>=64)}else{do{r+=l=this._getWhiteCode()}while(l>=64);do{c+=l=this._getBlackCode()}while(l>=64)}for(this._addPixels(e[this.codingPos]+r,i),e[this.codingPos]<n&&this._addPixels(e[this.codingPos]+c,1^i);t[s]<=e[this.codingPos]&&t[s]<n;)s+=2;break;case 7:if(this._addPixels(t[s]+3,i),i^=1,e[this.codingPos]<n)for(++s;t[s]<=e[this.codingPos]&&t[s]<n;)s+=2;break;case 5:if(this._addPixels(t[s]+2,i),i^=1,e[this.codingPos]<n)for(++s;t[s]<=e[this.codingPos]&&t[s]<n;)s+=2;break;case 3:if(this._addPixels(t[s]+1,i),i^=1,e[this.codingPos]<n)for(++s;t[s]<=e[this.codingPos]&&t[s]<n;)s+=2;break;case 2:if(this._addPixels(t[s],i),i^=1,e[this.codingPos]<n)for(++s;t[s]<=e[this.codingPos]&&t[s]<n;)s+=2;break;case 8:if(this._addPixelsNeg(t[s]-3,i),i^=1,e[this.codingPos]<n)for(s>0?--s:++s;t[s]<=e[this.codingPos]&&t[s]<n;)s+=2;break;case 6:if(this._addPixelsNeg(t[s]-2,i),i^=1,e[this.codingPos]<n)for(s>0?--s:++s;t[s]<=e[this.codingPos]&&t[s]<n;)s+=2;break;case 4:if(this._addPixelsNeg(t[s]-1,i),i^=1,e[this.codingPos]<n)for(s>0?--s:++s;t[s]<=e[this.codingPos]&&t[s]<n;)s+=2;break;case x:this._addPixels(n,0),this.eof=!0;break;default:o(),this._addPixels(n,0),this.err=!0}}else for(e[0]=0,this.codingPos=0,i=0;e[this.codingPos]<n;){if(r=0,i)do{r+=l=this._getBlackCode()}while(l>=64);else do{r+=l=this._getWhiteCode()}while(l>=64);this._addPixels(e[this.codingPos]+r,i),i^=1}let h=!1;if(this.byteAlign&&(this.inputBits&=-8),this.eoblock||this.row!==this.rows-1){if(r=this._lookBits(12),this.eoline)for(;r!==x&&1!==r;)this._eatBits(1),r=this._lookBits(12);else for(;0===r;)this._eatBits(1),r=this._lookBits(12);1===r?(this._eatBits(12),h=!0):r===x&&(this.eof=!0)}else this.rowsDone=!0;if(!this.eof&&this.encoding>0&&!this.rowsDone&&(this.nextLine2D=!this._lookBits(1),this._eatBits(1)),this.eoblock&&h&&this.byteAlign){if(r=this._lookBits(12),1===r){if(this._eatBits(12),this.encoding>0&&(this._lookBits(1),this._eatBits(1)),this.encoding>=0)for(a=0;a<4;++a)r=this._lookBits(12),1!==r&&o(),this._eatBits(12),this.encoding>0&&(this._lookBits(1),this._eatBits(1));this.eof=!0}}else if(this.err&&this.eoline){for(;;){if(r=this._lookBits(13),r===x)return this.eof=!0,-1;if(r>>1==1)break;this._eatBits(1)}this._eatBits(12),this.encoding>0&&(this._eatBits(1),this.nextLine2D=!(1&r))}this.outputBits=e[0]>0?e[this.codingPos=0]:e[this.codingPos=1],this.row++}if(this.outputBits>=8)c=1&this.codingPos?0:255,this.outputBits-=8,0===this.outputBits&&e[this.codingPos]<n&&(this.codingPos++,this.outputBits=e[this.codingPos]-e[this.codingPos-1]);else{r=8,c=0;do{if("number"!=typeof this.outputBits)throw new f('Invalid /CCITTFaxDecode data, "outputBits" must be a number.');this.outputBits>r?(c<<=r,1&this.codingPos||(c|=255>>8-r),this.outputBits-=r,r=0):(c<<=this.outputBits,1&this.codingPos||(c|=255>>8-this.outputBits),r-=this.outputBits,this.outputBits=0,e[this.codingPos]<n?(this.codingPos++,this.outputBits=e[this.codingPos]-e[this.codingPos-1]):r>0&&(c<<=r,r=0))}while(r)}return this.black&&(c^=255),c}_addPixels(t,e){const n=this.codingLine;let s=this.codingPos;t>n[s]&&(t>this.columns&&(o(),this.err=!0,t=this.columns),1&s^e&&++s,n[s]=t),this.codingPos=s}_addPixelsNeg(t,e){const n=this.codingLine;let s=this.codingPos;if(t>n[s])t>this.columns&&(o(),this.err=!0,t=this.columns),1&s^e&&++s,n[s]=t;else if(t<n[s]){for(t<0&&(o(),this.err=!0,t=0);s>0&&t<n[s-1];)--s;n[s]=t}this.codingPos=s}_findTableCode(t,e,n,s){const i=s||0;for(let s=t;s<=e;++s){let t=this._lookBits(s);if(t===x)return[!0,1,!1];if(s<e&&(t<<=e-s),!i||t>=i){const e=n[t-i];if(e[0]===s)return this._eatBits(s),[!0,e[1],!0]}}return[!1,0,!1]}_getTwoDimCode(){let t,e=0;if(this.eoblock){if(e=this._lookBits(7),t=k[e],t?.[0]>0)return this._eatBits(t[0]),t[1]}else{const t=this._findTableCode(1,7,k);if(t[0]&&t[2])return t[1]}return o(),x}_getWhiteCode(){let t,e=0;if(this.eoblock){if(e=this._lookBits(12),e===x)return 1;if(t=e>>5?A[e>>3]:B[e],t[0]>0)return this._eatBits(t[0]),t[1]}else{let t=this._findTableCode(1,9,A);if(t[0])return t[1];if(t=this._findTableCode(11,12,B),t[0])return t[1]}return o(),this._eatBits(1),1}_getBlackCode(){let t,e;if(this.eoblock){if(t=this._lookBits(13),t===x)return 1;if(e=t>>7?!(t>>9)&&t>>7?v[(t>>1)-64]:P[t>>7]:I[t],e[0]>0)return this._eatBits(e[0]),e[1]}else{let t=this._findTableCode(2,6,P);if(t[0])return t[1];if(t=this._findTableCode(7,12,v,64),t[0])return t[1];if(t=this._findTableCode(10,13,I),t[0])return t[1]}return o(),this._eatBits(1),1}_lookBits(t){let e;for(;this.inputBits<t;){if(-1===(e=this.source.next()))return 0===this.inputBits?x:this.inputBuf<<t-this.inputBits&65535>>16-t;this.inputBuf=this.inputBuf<<8|e,this.inputBits+=8}return this.inputBuf>>this.inputBits-t&65535>>16-t}_eatBits(t){(this.inputBits-=t)<0&&(this.inputBits=0)}}class D extends h{constructor(t){super(t,"Jbig2Error")}}class S{getContexts(t){return t in this?this[t]:this[t]=new Int8Array(65536)}}class _{constructor(t,e,n){this.data=t,this.start=e,this.end=n}get decoder(){return l(this,"decoder",new y(this.data,this.start,this.end))}get contextCache(){return l(this,"contextCache",new S)}}function T(t,e,n){const s=t.getContexts(e);let i=1;function r(t){let e=0;for(let r=0;r<t;r++){const t=n.readBit(s,i);i=i<256?i<<1|t:511&(i<<1|t)|256,e=e<<1|t}return e>>>0}const o=r(1),a=r(1)?r(1)?r(1)?r(1)?r(1)?r(32)+4436:r(12)+340:r(8)+84:r(6)+20:r(4)+4:r(2);let c;return 0===o?c=a:a>0&&(c=-a),c>=-2147483648&&c<=2147483647?c:null}function L(t,e,n){const s=t.getContexts("IAID");let i=1;for(let t=0;t<n;t++)i=i<<1|e.readBit(s,i);return n<31?i&(1<<n)-1:2147483647&i}const R=["SymbolDictionary",null,null,null,"IntermediateTextRegion",null,"ImmediateTextRegion","ImmediateLosslessTextRegion",null,null,null,null,null,null,null,null,"PatternDictionary",null,null,null,"IntermediateHalftoneRegion",null,"ImmediateHalftoneRegion","ImmediateLosslessHalftoneRegion",null,null,null,null,null,null,null,null,null,null,null,null,"IntermediateGenericRegion",null,"ImmediateGenericRegion","ImmediateLosslessGenericRegion","IntermediateGenericRefinementRegion",null,"ImmediateGenericRefinementRegion","ImmediateLosslessGenericRefinementRegion",null,null,null,null,"PageInformation","EndOfPage","EndOfStripe","EndOfFile","Profiles","Tables",null,null,null,null,null,null,null,null,"Extension"],F=[[{x:-1,y:-2},{x:0,y:-2},{x:1,y:-2},{x:-2,y:-1},{x:-1,y:-1},{x:0,y:-1},{x:1,y:-1},{x:2,y:-1},{x:-4,y:0},{x:-3,y:0},{x:-2,y:0},{x:-1,y:0}],[{x:-1,y:-2},{x:0,y:-2},{x:1,y:-2},{x:2,y:-2},{x:-2,y:-1},{x:-1,y:-1},{x:0,y:-1},{x:1,y:-1},{x:2,y:-1},{x:-3,y:0},{x:-2,y:0},{x:-1,y:0}],[{x:-1,y:-2},{x:0,y:-2},{x:1,y:-2},{x:-2,y:-1},{x:-1,y:-1},{x:0,y:-1},{x:1,y:-1},{x:-2,y:0},{x:-1,y:0}],[{x:-3,y:-1},{x:-2,y:-1},{x:-1,y:-1},{x:0,y:-1},{x:1,y:-1},{x:-4,y:0},{x:-3,y:0},{x:-2,y:0},{x:-1,y:0}]],E=[{coding:[{x:0,y:-1},{x:1,y:-1},{x:-1,y:0}],reference:[{x:0,y:-1},{x:1,y:-1},{x:-1,y:0},{x:0,y:0},{x:1,y:0},{x:-1,y:1},{x:0,y:1},{x:1,y:1}]},{coding:[{x:-1,y:-1},{x:0,y:-1},{x:1,y:-1},{x:-1,y:0}],reference:[{x:0,y:-1},{x:-1,y:0},{x:0,y:0},{x:1,y:0},{x:0,y:1},{x:1,y:1}]}],O=[39717,1941,229,405],U=[32,8];function q(t,e,n,s,i,r,o,a){if(t)return nt(new Z(a.data,a.start,a.end),e,n,!1);if(0===s&&!r&&!i&&4===o.length&&3===o[0].x&&-1===o[0].y&&-3===o[1].x&&-1===o[1].y&&2===o[2].x&&-2===o[2].y&&-2===o[3].x&&-2===o[3].y)return function(t,e,n){const s=n.decoder,i=n.contextCache.getContexts("GB"),r=[];let o,a,c,l,h,f,u;for(a=0;a<e;a++)for(h=r[a]=new Uint8Array(t),f=a<1?h:r[a-1],u=a<2?h:r[a-2],o=u[0]<<13|u[1]<<12|u[2]<<11|f[0]<<7|f[1]<<6|f[2]<<5|f[3]<<4,c=0;c<t;c++)h[c]=l=s.readBit(i,o),o=(31735&o)<<1|(c+3<t?u[c+3]<<11:0)|(c+4<t?f[c+4]<<4:0)|l;return r}(e,n,a);const c=!!r,l=F[s].concat(o);l.sort((function(t,e){return t.y-e.y||t.x-e.x}));const h=l.length,f=new Int8Array(h),u=new Int8Array(h),d=[];let m,g,p=0,w=0,b=0,y=0;for(g=0;g<h;g++)f[g]=l[g].x,u[g]=l[g].y,w=Math.min(w,l[g].x),b=Math.max(b,l[g].x),y=Math.min(y,l[g].y),g<h-1&&l[g].y===l[g+1].y&&l[g].x===l[g+1].x-1?p|=1<<h-1-g:d.push(g);const x=d.length,k=new Int8Array(x),B=new Int8Array(x),A=new Uint16Array(x);for(m=0;m<x;m++)g=d[m],k[m]=l[g].x,B[m]=l[g].y,A[m]=1<<h-1-g;const I=-w,v=-y,P=e-b,C=O[s];let D=new Uint8Array(e);const S=[],_=a.decoder,T=a.contextCache.getContexts("GB");let L,R,E,U,q,H=0,N=0;for(let t=0;t<n;t++)if(i&&(H^=_.readBit(T,C),H))S.push(D);else for(D=new Uint8Array(D),S.push(D),L=0;L<e;L++){if(c&&r[t][L]){D[L]=0;continue}if(L>=I&&L<P&&t>=v)for(N=N<<1&p,g=0;g<x;g++)R=t+B[g],E=L+k[g],U=S[R][E],U&&(U=A[g],N|=U);else for(N=0,q=h-1,g=0;g<h;g++,q--)E=L+f[g],E>=0&&E<e&&(R=t+u[g],R>=0&&(U=S[R][E],U&&(N|=U<<q)));const n=_.readBit(T,N);D[L]=n}return S}function H(t,e,n,s,i,r,o,a,c){let l=E[n].coding;0===n&&(l=l.concat([a[0]]));const h=l.length,f=new Int32Array(h),u=new Int32Array(h);let d;for(d=0;d<h;d++)f[d]=l[d].x,u[d]=l[d].y;let m=E[n].reference;0===n&&(m=m.concat([a[1]]));const g=m.length,p=new Int32Array(g),w=new Int32Array(g);for(d=0;d<g;d++)p[d]=m[d].x,w[d]=m[d].y;const b=s[0].length,y=s.length,x=U[n],k=[],B=c.decoder,A=c.contextCache.getContexts("GR");let I=0;for(let n=0;n<e;n++){if(o&&(I^=B.readBit(A,x),I))throw new D("prediction is not supported");const e=new Uint8Array(t);k.push(e);for(let o=0;o<t;o++){let a,c,l=0;for(d=0;d<h;d++)a=n+u[d],c=o+f[d],a<0||c<0||c>=t?l<<=1:l=l<<1|k[a][c];for(d=0;d<g;d++)a=n+w[d]-r,c=o+p[d]-i,a<0||a>=y||c<0||c>=b?l<<=1:l=l<<1|s[a][c];const m=B.readBit(A,l);e[o]=m}}return k}function N(t,e,n,s,i,r,o,a,c,l,h,f,u,d,m,g,p,w,b){if(t&&e)throw new D("refinement with Huffman is not supported");const y=[];let x,k;for(x=0;x<s;x++)k=new Uint8Array(n),i&&k.fill(i),y.push(k);const B=p.decoder,A=p.contextCache;let I=t?-d.tableDeltaT.decode(b):-T(A,"IADT",B),v=0;for(x=0;x<r;){I+=t?d.tableDeltaT.decode(b):T(A,"IADT",B),v+=t?d.tableFirstS.decode(b):T(A,"IAFS",B);let s=v;for(;;){let i=0;o>1&&(i=t?b.readBits(w):T(A,"IAIT",B));const r=o*I+i,v=t?d.symbolIDTable.decode(b):L(A,B,c),P=e&&(t?b.readBit():T(A,"IARI",B));let C=a[v],S=C[0].length,_=C.length;if(P){const t=T(A,"IARDW",B),e=T(A,"IARDH",B);S+=t,_+=e,C=H(S,_,m,C,(t>>1)+T(A,"IARDX",B),(e>>1)+T(A,"IARDY",B),!1,g,p)}let R=0;l?1&f?R=_-1:s+=_-1:f>1?s+=S-1:R=S-1;const F=r-(1&f?0:_-1),E=s-(2&f?S-1:0);let O,U,q;if(l)for(O=0;O<_;O++){if(k=y[E+O],!k)continue;q=C[O];const t=Math.min(n-F,S);switch(u){case 0:for(U=0;U<t;U++)k[F+U]|=q[U];break;case 2:for(U=0;U<t;U++)k[F+U]^=q[U];break;default:throw new D(`operator ${u} is not supported`)}}else for(U=0;U<_;U++)if(k=y[F+U],k)switch(q=C[U],u){case 0:for(O=0;O<S;O++)k[E+O]|=q[O];break;case 2:for(O=0;O<S;O++)k[E+O]^=q[O];break;default:throw new D(`operator ${u} is not supported`)}x++;const N=t?d.tableDeltaS.decode(b):T(A,"IADS",B);if(null===N)break;s+=R+N+h}}return y}function W(t,e){const n={};n.number=w(t,e);const s=t[e+4],i=63&s;if(!R[i])throw new D("invalid segment type: "+i);n.type=i,n.typeName=R[i],n.deferredNonRetain=!!(128&s);const r=!!(64&s),o=t[e+5];let a=o>>5&7;const c=[31&o];let l=e+6;if(7===o){a=536870911&w(t,l-1),l+=3;let e=a+7>>3;for(c[0]=t[l++];--e>0;)c.push(t[l++])}else if(5===o||6===o)throw new D("invalid referred-to flags");n.retainBits=c;let h=4;n.number<=256?h=1:n.number<=65536&&(h=2);const f=[];let u,d;for(u=0;u<a;u++){let e;e=1===h?t[l]:2===h?p(t,l):w(t,l),f.push(e),l+=h}if(n.referredTo=f,r?(n.pageAssociation=w(t,l),l+=4):n.pageAssociation=t[l++],n.length=w(t,l),l+=4,4294967295===n.length){if(38!==i)throw new D("invalid unknown segment length");{const e=J(t,l),s=!!(1&t[l+j]),i=6,r=new Uint8Array(i);for(s||(r[0]=255,r[1]=172),r[2]=e.height>>>24&255,r[3]=e.height>>16&255,r[4]=e.height>>8&255,r[5]=255&e.height,u=l,d=t.length;u<d;u++){let e=0;for(;e<i&&r[e]===t[u+e];)e++;if(e===i){n.length=u+i;break}}if(4294967295===n.length)throw new D("segment end was not found")}}return n.headerEnd=l,n}function M(t,e,n,s){const i=[];let r=n;for(;r<s;){const n=W(e,r);r=n.headerEnd;const s={header:n,data:e};if(t.randomAccess||(s.start=r,r+=n.length,s.end=r),i.push(s),51===n.type)break}if(t.randomAccess)for(let t=0,e=i.length;t<e;t++)i[t].start=r,r+=i[t].header.length,i[t].end=r;return i}function J(t,e){return{width:w(t,e),height:w(t,e+4),x:w(t,e+8),y:w(t,e+12),combinationOperator:7&t[e+16]}}const j=17;function G(t,e){const n=t.header,s=t.data,i=t.end;let r,o,a,c,l=t.start;switch(n.type){case 0:const t={},e=p(s,l);if(t.huffman=!!(1&e),t.refinement=!!(2&e),t.huffmanDHSelector=e>>2&3,t.huffmanDWSelector=e>>4&3,t.bitmapSizeSelector=e>>6&1,t.aggregationInstancesSelector=e>>7&1,t.bitmapCodingContextUsed=!!(256&e),t.bitmapCodingContextRetained=!!(512&e),t.template=e>>10&3,t.refinementTemplate=e>>12&1,l+=2,!t.huffman){for(c=0===t.template?4:1,o=[],a=0;a<c;a++)o.push({x:g(s,l),y:g(s,l+1)}),l+=2;t.at=o}if(t.refinement&&!t.refinementTemplate){for(o=[],a=0;a<2;a++)o.push({x:g(s,l),y:g(s,l+1)}),l+=2;t.refinementAt=o}t.numberOfExportedSymbols=w(s,l),l+=4,t.numberOfNewSymbols=w(s,l),l+=4,r=[t,n.number,n.referredTo,s,l,i];break;case 6:case 7:const h={};h.info=J(s,l),l+=j;const f=p(s,l);if(l+=2,h.huffman=!!(1&f),h.refinement=!!(2&f),h.logStripSize=f>>2&3,h.stripSize=1<<h.logStripSize,h.referenceCorner=f>>4&3,h.transposed=!!(64&f),h.combinationOperator=f>>7&3,h.defaultPixelValue=f>>9&1,h.dsOffset=f<<17>>27,h.refinementTemplate=f>>15&1,h.huffman){const t=p(s,l);l+=2,h.huffmanFS=3&t,h.huffmanDS=t>>2&3,h.huffmanDT=t>>4&3,h.huffmanRefinementDW=t>>6&3,h.huffmanRefinementDH=t>>8&3,h.huffmanRefinementDX=t>>10&3,h.huffmanRefinementDY=t>>12&3,h.huffmanRefinementSizeSelector=!!(16384&t)}if(h.refinement&&!h.refinementTemplate){for(o=[],a=0;a<2;a++)o.push({x:g(s,l),y:g(s,l+1)}),l+=2;h.refinementAt=o}h.numberOfSymbolInstances=w(s,l),l+=4,r=[h,n.referredTo,s,l,i];break;case 16:const u={},d=s[l++];u.mmr=!!(1&d),u.template=d>>1&3,u.patternWidth=s[l++],u.patternHeight=s[l++],u.maxPatternIndex=w(s,l),l+=4,r=[u,n.number,s,l,i];break;case 22:case 23:const m={};m.info=J(s,l),l+=j;const b=s[l++];m.mmr=!!(1&b),m.template=b>>1&3,m.enableSkip=!!(8&b),m.combinationOperator=b>>4&7,m.defaultPixelValue=b>>7&1,m.gridWidth=w(s,l),l+=4,m.gridHeight=w(s,l),l+=4,m.gridOffsetX=4294967295&w(s,l),l+=4,m.gridOffsetY=4294967295&w(s,l),l+=4,m.gridVectorX=p(s,l),l+=2,m.gridVectorY=p(s,l),l+=2,r=[m,n.referredTo,s,l,i];break;case 38:case 39:const y={};y.info=J(s,l),l+=j;const x=s[l++];if(y.mmr=!!(1&x),y.template=x>>1&3,y.prediction=!!(8&x),!y.mmr){for(c=0===y.template?4:1,o=[],a=0;a<c;a++)o.push({x:g(s,l),y:g(s,l+1)}),l+=2;y.at=o}r=[y,s,l,i];break;case 48:const k={width:w(s,l),height:w(s,l+4),resolutionX:w(s,l+8),resolutionY:w(s,l+12)};4294967295===k.height&&delete k.height;const B=s[l+16];p(s,l+17),k.lossless=!!(1&B),k.refinement=!!(2&B),k.defaultPixelValue=B>>2&1,k.combinationOperator=B>>3&3,k.requiresBuffer=!!(32&B),k.combinationOperatorOverride=!!(64&B),r=[k];break;case 49:case 50:case 51:case 62:break;case 53:r=[n.number,s,l,i];break;default:throw new D(`segment type ${n.typeName}(${n.type}) is not implemented`)}const h="on"+n.typeName;h in e&&e[h].apply(e,r)}function V(t,e){for(let n=0,s=t.length;n<s;n++)G(t[n],e)}class z{onPageInformation(t){this.currentPageInfo=t;const e=t.width+7>>3,n=new Uint8ClampedArray(e*t.height);t.defaultPixelValue&&n.fill(255),this.buffer=n}drawBitmap(t,e){const n=this.currentPageInfo,s=t.width,i=t.height,r=n.width+7>>3,o=n.combinationOperatorOverride?t.combinationOperator:n.combinationOperator,a=this.buffer,c=128>>(7&t.x);let l,h,f,u,d=t.y*r+(t.x>>3);switch(o){case 0:for(l=0;l<i;l++){for(f=c,u=d,h=0;h<s;h++)e[l][h]&&(a[u]|=f),f>>=1,f||(f=128,u++);d+=r}break;case 2:for(l=0;l<i;l++){for(f=c,u=d,h=0;h<s;h++)e[l][h]&&(a[u]^=f),f>>=1,f||(f=128,u++);d+=r}break;default:throw new D(`operator ${o} is not supported`)}}onImmediateGenericRegion(t,e,n,s){const i=t.info,r=new _(e,n,s),o=q(t.mmr,i.width,i.height,t.template,t.prediction,null,t.at,r);this.drawBitmap(i,o)}onImmediateLosslessGenericRegion(){this.onImmediateGenericRegion(...arguments)}onSymbolDictionary(t,e,n,s,i,r){let o,a;t.huffman&&(o=function(t,e,n){let s,i,r,o,a=0;switch(t.huffmanDHSelector){case 0:case 1:s=Q(t.huffmanDHSelector+4);break;case 3:s=tt(a,e,n),a++;break;default:throw new D("invalid Huffman DH selector")}switch(t.huffmanDWSelector){case 0:case 1:i=Q(t.huffmanDWSelector+2);break;case 3:i=tt(a,e,n),a++;break;default:throw new D("invalid Huffman DW selector")}return t.bitmapSizeSelector?(r=tt(a,e,n),a++):r=Q(1),o=t.aggregationInstancesSelector?tt(a,e,n):Q(1),{tableDeltaHeight:s,tableDeltaWidth:i,tableBitmapSize:r,tableAggregateInstances:o}}(t,n,this.customTables),a=new Z(s,i,r));let c=this.symbols;c||(this.symbols=c={});const l=[];for(const t of n){const e=c[t];e&&l.push(...e)}const h=new _(s,i,r);c[e]=function(t,e,n,s,i,r,o,a,c,l,h,f){if(t&&e)throw new D("symbol refinement with Huffman is not supported");const u=[];let d=0,g=m(n.length+s);const p=h.decoder,w=h.contextCache;let b,y;for(t&&(b=Q(1),y=[],g=Math.max(g,1));u.length<s;){d+=t?r.tableDeltaHeight.decode(f):T(w,"IADH",p);let s=0,i=0;const m=t?y.length:0;for(;;){const m=t?r.tableDeltaWidth.decode(f):T(w,"IADW",p);if(null===m)break;let b;if(s+=m,i+=s,e){const i=T(w,"IAAI",p);if(i>1)b=N(t,e,s,d,0,i,1,n.concat(u),g,0,0,1,0,r,c,l,h,0,f);else{const t=L(w,p,g),e=T(w,"IARDX",p),i=T(w,"IARDY",p);b=H(s,d,c,t<n.length?n[t]:u[t-n.length],e,i,!1,l,h)}u.push(b)}else t?y.push(s):(b=q(!1,s,d,o,!1,null,a,h),u.push(b))}if(t&&!e){const t=r.tableBitmapSize.decode(f);let e;if(f.byteAlign(),0===t)e=et(f,i,d);else{const n=f.end,s=f.position+t;f.end=s,e=nt(f,i,d,!1),f.end=n,f.position=s}const n=y.length;if(m===n-1)u.push(e);else{let t,s,i,r,o,a=0;for(t=m;t<n;t++){for(r=y[t],i=a+r,o=[],s=0;s<d;s++)o.push(e[s].subarray(a,i));u.push(o),a=i}}}}const x=[],k=[];let B,A,I=!1;const v=n.length+s;for(;k.length<v;){let e=t?b.decode(f):T(w,"IAEX",p);for(;e--;)k.push(I);I=!I}for(B=0,A=n.length;B<A;B++)k[B]&&x.push(n[B]);for(let t=0;t<s;B++,t++)k[B]&&x.push(u[t]);return x}(t.huffman,t.refinement,l,t.numberOfNewSymbols,t.numberOfExportedSymbols,o,t.template,t.at,t.refinementTemplate,t.refinementAt,h,a)}onImmediateTextRegion(t,e,n,s,i){const r=t.info;let o,a;const c=this.symbols,l=[];for(const t of e){const e=c[t];e&&l.push(...e)}const h=m(l.length);t.huffman&&(a=new Z(n,s,i),o=function(t,e,n,s,i){const r=[];for(let t=0;t<=34;t++){const e=i.readBits(4);r.push(new Y([t,e,0,0]))}const o=new X(r,!1);r.length=0;for(let t=0;t<s;){const e=o.decode(i);if(e>=32){let n,s,o;switch(e){case 32:if(0===t)throw new D("no previous value in symbol ID table");s=i.readBits(2)+3,n=r[t-1].prefixLength;break;case 33:s=i.readBits(3)+3,n=0;break;case 34:s=i.readBits(7)+11,n=0;break;default:throw new D("invalid code length in symbol ID table")}for(o=0;o<s;o++)r.push(new Y([t,n,0,0])),t++}else r.push(new Y([t,e,0,0])),t++}i.byteAlign();const a=new X(r,!1);let c,l,h,f=0;switch(t.huffmanFS){case 0:case 1:c=Q(t.huffmanFS+6);break;case 3:c=tt(f,e,n),f++;break;default:throw new D("invalid Huffman FS selector")}switch(t.huffmanDS){case 0:case 1:case 2:l=Q(t.huffmanDS+8);break;case 3:l=tt(f,e,n),f++;break;default:throw new D("invalid Huffman DS selector")}switch(t.huffmanDT){case 0:case 1:case 2:h=Q(t.huffmanDT+11);break;case 3:h=tt(f,e,n),f++;break;default:throw new D("invalid Huffman DT selector")}if(t.refinement)throw new D("refinement with Huffman is not supported");return{symbolIDTable:a,tableFirstS:c,tableDeltaS:l,tableDeltaT:h}}(t,e,this.customTables,l.length,a));const f=new _(n,s,i),u=N(t.huffman,t.refinement,r.width,r.height,t.defaultPixelValue,t.numberOfSymbolInstances,t.stripSize,l,h,t.transposed,t.dsOffset,t.referenceCorner,t.combinationOperator,o,t.refinementTemplate,t.refinementAt,f,t.logStripSize,a);this.drawBitmap(r,u)}onImmediateLosslessTextRegion(){this.onImmediateTextRegion(...arguments)}onPatternDictionary(t,e,n,s,i){let r=this.patterns;r||(this.patterns=r={});const o=new _(n,s,i);r[e]=function(t,e,n,s,i,r){const o=[];t||(o.push({x:-e,y:0}),0===i&&o.push({x:-3,y:-1},{x:2,y:-2},{x:-2,y:-2}));const a=q(t,(s+1)*e,n,i,!1,null,o,r),c=[];for(let t=0;t<=s;t++){const s=[],i=e*t,r=i+e;for(let t=0;t<n;t++)s.push(a[t].subarray(i,r));c.push(s)}return c}(t.mmr,t.patternWidth,t.patternHeight,t.maxPatternIndex,t.template,o)}onImmediateHalftoneRegion(t,e,n,s,i){const r=this.patterns[e[0]],o=t.info,a=new _(n,s,i),c=function(t,e,n,s,i,r,o,a,c,l,h,f,u,d,g){if(o)throw new D("skip is not supported");if(0!==a)throw new D(`operator "${a}" is not supported in halftone region`);const p=[];let w,b,y;for(w=0;w<i;w++)y=new Uint8Array(s),r&&y.fill(r),p.push(y);const x=e.length,k=e[0],B=k[0].length,A=k.length,I=m(x),v=[];t||(v.push({x:n<=1?3:2,y:-1}),0===n&&v.push({x:-3,y:-1},{x:2,y:-2},{x:-2,y:-2}));const P=[];let C,S,_,T,L,R,F,E,O,U,H;for(t&&(C=new Z(g.data,g.start,g.end)),w=I-1;w>=0;w--)S=t?nt(C,c,l,!0):q(!1,c,l,n,!1,null,v,g),P[w]=S;for(_=0;_<l;_++)for(T=0;T<c;T++){for(L=0,R=0,b=I-1;b>=0;b--)L^=P[b][_][T],R|=L<<b;if(F=e[R],E=h+_*d+T*u>>8,O=f+_*u-T*d>>8,E>=0&&E+B<=s&&O>=0&&O+A<=i)for(w=0;w<A;w++)for(H=p[O+w],U=F[w],b=0;b<B;b++)H[E+b]|=U[b];else{let t,e;for(w=0;w<A;w++)if(e=O+w,!(e<0||e>=i))for(H=p[e],U=F[w],b=0;b<B;b++)t=E+b,t>=0&&t<s&&(H[t]|=U[b])}}return p}(t.mmr,r,t.template,o.width,o.height,t.defaultPixelValue,t.enableSkip,t.combinationOperator,t.gridWidth,t.gridHeight,t.gridOffsetX,t.gridOffsetY,t.gridVectorX,t.gridVectorY,a);this.drawBitmap(o,c)}onImmediateLosslessHalftoneRegion(){this.onImmediateHalftoneRegion(...arguments)}onTables(t,e,n,s){let i=this.customTables;i||(this.customTables=i={}),i[t]=function(t,e,n){const s=t[e],i=4294967295&w(t,e+1),r=4294967295&w(t,e+5),o=new Z(t,e+9,n),a=1+(s>>1&7),c=1+(s>>4&7),l=[];let h,f,u=i;do{h=o.readBits(a),f=o.readBits(c),l.push(new Y([u,h,f,0])),u+=1<<f}while(u<r);return h=o.readBits(a),l.push(new Y([i-1,h,32,0,"lower"])),h=o.readBits(a),l.push(new Y([r,h,32,0])),1&s&&(h=o.readBits(a),l.push(new Y([h,0]))),new X(l,!1)}(e,n,s)}}class Y{constructor(t){2===t.length?(this.isOOB=!0,this.rangeLow=0,this.prefixLength=t[0],this.rangeLength=0,this.prefixCode=t[1],this.isLowerRange=!1):(this.isOOB=!1,this.rangeLow=t[0],this.prefixLength=t[1],this.rangeLength=t[2],this.prefixCode=t[3],this.isLowerRange="lower"===t[4])}}class ${constructor(t){this.children=[],t?(this.isLeaf=!0,this.rangeLength=t.rangeLength,this.rangeLow=t.rangeLow,this.isLowerRange=t.isLowerRange,this.isOOB=t.isOOB):this.isLeaf=!1}buildTree(t,e){const n=t.prefixCode>>e&1;if(e<=0)this.children[n]=new $(t);else{let s=this.children[n];s||(this.children[n]=s=new $(null)),s.buildTree(t,e-1)}}decodeNode(t){if(this.isLeaf){if(this.isOOB)return null;const e=t.readBits(this.rangeLength);return this.rangeLow+(this.isLowerRange?-e:e)}const e=this.children[t.readBit()];if(!e)throw new D("invalid Huffman data");return e.decodeNode(t)}}class X{constructor(t,e){e||this.assignPrefixCodes(t),this.rootNode=new $(null);for(let e=0,n=t.length;e<n;e++){const n=t[e];n.prefixLength>0&&this.rootNode.buildTree(n,n.prefixLength-1)}}decode(t){return this.rootNode.decodeNode(t)}assignPrefixCodes(t){const e=t.length;let n=0;for(let s=0;s<e;s++)n=Math.max(n,t[s].prefixLength);const s=new Uint32Array(n+1);for(let n=0;n<e;n++)s[t[n].prefixLength]++;let i,r,o,a=1,c=0;for(s[0]=0;a<=n;){for(c=c+s[a-1]<<1,i=c,r=0;r<e;)o=t[r],o.prefixLength===a&&(o.prefixCode=i,i++),r++;a++}}}const K={};function Q(t){let e,n=K[t];if(n)return n;switch(t){case 1:e=[[0,1,4,0],[16,2,8,2],[272,3,16,6],[65808,3,32,7]];break;case 2:e=[[0,1,0,0],[1,2,0,2],[2,3,0,6],[3,4,3,14],[11,5,6,30],[75,6,32,62],[6,63]];break;case 3:e=[[-256,8,8,254],[0,1,0,0],[1,2,0,2],[2,3,0,6],[3,4,3,14],[11,5,6,30],[-257,8,32,255,"lower"],[75,7,32,126],[6,62]];break;case 4:e=[[1,1,0,0],[2,2,0,2],[3,3,0,6],[4,4,3,14],[12,5,6,30],[76,5,32,31]];break;case 5:e=[[-255,7,8,126],[1,1,0,0],[2,2,0,2],[3,3,0,6],[4,4,3,14],[12,5,6,30],[-256,7,32,127,"lower"],[76,6,32,62]];break;case 6:e=[[-2048,5,10,28],[-1024,4,9,8],[-512,4,8,9],[-256,4,7,10],[-128,5,6,29],[-64,5,5,30],[-32,4,5,11],[0,2,7,0],[128,3,7,2],[256,3,8,3],[512,4,9,12],[1024,4,10,13],[-2049,6,32,62,"lower"],[2048,6,32,63]];break;case 7:e=[[-1024,4,9,8],[-512,3,8,0],[-256,4,7,9],[-128,5,6,26],[-64,5,5,27],[-32,4,5,10],[0,4,5,11],[32,5,5,28],[64,5,6,29],[128,4,7,12],[256,3,8,1],[512,3,9,2],[1024,3,10,3],[-1025,5,32,30,"lower"],[2048,5,32,31]];break;case 8:e=[[-15,8,3,252],[-7,9,1,508],[-5,8,1,253],[-3,9,0,509],[-2,7,0,124],[-1,4,0,10],[0,2,1,0],[2,5,0,26],[3,6,0,58],[4,3,4,4],[20,6,1,59],[22,4,4,11],[38,4,5,12],[70,5,6,27],[134,5,7,28],[262,6,7,60],[390,7,8,125],[646,6,10,61],[-16,9,32,510,"lower"],[1670,9,32,511],[2,1]];break;case 9:e=[[-31,8,4,252],[-15,9,2,508],[-11,8,2,253],[-7,9,1,509],[-5,7,1,124],[-3,4,1,10],[-1,3,1,2],[1,3,1,3],[3,5,1,26],[5,6,1,58],[7,3,5,4],[39,6,2,59],[43,4,5,11],[75,4,6,12],[139,5,7,27],[267,5,8,28],[523,6,8,60],[779,7,9,125],[1291,6,11,61],[-32,9,32,510,"lower"],[3339,9,32,511],[2,0]];break;case 10:e=[[-21,7,4,122],[-5,8,0,252],[-4,7,0,123],[-3,5,0,24],[-2,2,2,0],[2,5,0,25],[3,6,0,54],[4,7,0,124],[5,8,0,253],[6,2,6,1],[70,5,5,26],[102,6,5,55],[134,6,6,56],[198,6,7,57],[326,6,8,58],[582,6,9,59],[1094,6,10,60],[2118,7,11,125],[-22,8,32,254,"lower"],[4166,8,32,255],[2,2]];break;case 11:e=[[1,1,0,0],[2,2,1,2],[4,4,0,12],[5,4,1,13],[7,5,1,28],[9,5,2,29],[13,6,2,60],[17,7,2,122],[21,7,3,123],[29,7,4,124],[45,7,5,125],[77,7,6,126],[141,7,32,127]];break;case 12:e=[[1,1,0,0],[2,2,0,2],[3,3,1,6],[5,5,0,28],[6,5,1,29],[8,6,1,60],[10,7,0,122],[11,7,1,123],[13,7,2,124],[17,7,3,125],[25,7,4,126],[41,8,5,254],[73,8,32,255]];break;case 13:e=[[1,1,0,0],[2,3,0,4],[3,4,0,12],[4,5,0,28],[5,4,1,13],[7,3,3,5],[15,6,1,58],[17,6,2,59],[21,6,3,60],[29,6,4,61],[45,6,5,62],[77,7,6,126],[141,7,32,127]];break;case 14:e=[[-2,3,0,4],[-1,3,0,5],[0,1,0,0],[1,3,0,6],[2,3,0,7]];break;case 15:e=[[-24,7,4,124],[-8,6,2,60],[-4,5,1,28],[-2,4,0,12],[-1,3,0,4],[0,1,0,0],[1,3,0,5],[2,4,0,13],[3,5,1,29],[5,6,2,61],[9,7,4,125],[-25,7,32,126,"lower"],[25,7,32,127]];break;default:throw new D(`standard table B.${t} does not exist`)}for(let t=0,n=e.length;t<n;t++)e[t]=new Y(e[t]);return n=new X(e,!0),K[t]=n,n}class Z{constructor(t,e,n){this.data=t,this.start=e,this.end=n,this.position=e,this.shift=-1,this.currentByte=0}readBit(){if(this.shift<0){if(this.position>=this.end)throw new D("end of data while reading bit");this.currentByte=this.data[this.position++],this.shift=7}const t=this.currentByte>>this.shift&1;return this.shift--,t}readBits(t){let e,n=0;for(e=t-1;e>=0;e--)n|=this.readBit()<<e;return n}byteAlign(){this.shift=-1}next(){return this.position>=this.end?-1:this.data[this.position++]}}function tt(t,e,n){let s=0;for(let i=0,r=e.length;i<r;i++){const r=n[e[i]];if(r){if(t===s)return r;s++}}throw new D("can't find custom Huffman table")}function et(t,e,n){const s=[];for(let i=0;i<n;i++){const n=new Uint8Array(e);s.push(n);for(let s=0;s<e;s++)n[s]=t.readBit();t.byteAlign()}return s}function nt(t,e,n,s){const i=new C(t,{K:-1,Columns:e,Rows:n,BlackIs1:!0,EndOfBlock:s}),r=[];let o,a=!1;for(let t=0;t<n;t++){const t=new Uint8Array(e);r.push(t);let n=-1;for(let s=0;s<e;s++)n<0&&(o=i.readNextChar(),-1===o&&(o=0,a=!0),n=7),t[s]=o>>n&1,n--}if(s&&!a){const t=5;for(let e=0;e<t&&-1!==i.readNextChar();e++);}return r}class st{parseChunks(t){return function(t){const e=new z;for(let n=0,s=t.length;n<s;n++){const s=t[n];V(M({},s.data,s.start,s.end),e)}return e.buffer}(t)}parse(t){const{imgData:e,width:n,height:s}=function(t){const e=t.length;let n=0;if(151!==t[n]||74!==t[n+1]||66!==t[n+2]||50!==t[n+3]||13!==t[n+4]||10!==t[n+5]||26!==t[n+6]||10!==t[n+7])throw new D("parseJbig2 - invalid header.");const s=Object.create(null);n+=8;const i=t[n++];s.randomAccess=!(1&i),2&i||(s.numberOfPages=w(t,n),n+=4);const r=M(s,t,n,e),o=new z;V(r,o);const{width:a,height:c}=o.currentPageInfo,l=o.buffer,h=new Uint8ClampedArray(a*c);let f=0,u=0;for(let t=0;t<c;t++){let t,e=0;for(let n=0;n<a;n++)e||(e=128,t=l[u++]),h[f++]=t&e?0:255,e>>=1}return{imgData:h,width:a,height:c}}(t);return this.width=n,this.height=s,e}}class it extends h{constructor(t){super(t,"JpegError")}}class rt extends h{constructor(t,e){super(t,"DNLMarkerError"),this.scanLines=e}}class ot extends h{constructor(t){super(t,"EOIMarkerError")}}const at=new Uint8Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]),ct=4017,lt=799,ht=3406,ft=2276,ut=1567,dt=3784,mt=5793,gt=2896;function pt(t,e){let n,s,i=0,r=16;for(;r>0&&!t[r-1];)r--;const o=[{children:[],index:0}];let a,c=o[0];for(n=0;n<r;n++){for(s=0;s<t[n];s++){for(c=o.pop(),c.children[c.index]=e[i];c.index>0;)c=o.pop();for(c.index++,o.push(c);o.length<=n;)o.push(a={children:[],index:0}),c.children[c.index]=a.children,c=a;i++}n+1<r&&(o.push(a={children:[],index:0}),c.children[c.index]=a.children,c=a)}return o[0].children}function wt(t,e,n){return 64*((t.blocksPerLine+1)*e+n)}function bt(t,e,n,s,i,r,o,c,l,h=!1){const f=n.mcusPerLine,u=n.progressive,d=e;let m=0,g=0;function w(){if(g>0)return g--,m>>g&1;if(m=t[e++],255===m){const s=t[e++];if(s){if(220===s&&h){const s=p(t,e+=2);if(e+=2,s>0&&s!==n.scanLines)throw new rt("Found DNL marker (0xFFDC) while parsing scan data",s)}else if(217===s){if(h){const t=I*(8===n.precision?8:0);if(t>0&&Math.round(n.scanLines/t)>=5)throw new rt("Found EOI marker (0xFFD9) while parsing scan data, possibly caused by incorrect `scanLines` parameter",t)}throw new ot("Found EOI marker (0xFFD9) while parsing scan data")}throw new it(`unexpected marker ${(m<<8|s).toString(16)}`)}}return g=7,m>>>7}function b(t){let e=t;for(;;){switch(e=e[w()],typeof e){case"number":return e;case"object":continue}throw new it("invalid huffman sequence")}}function y(t){let e=0;for(;t>0;)e=e<<1|w(),t--;return e}function x(t){if(1===t)return 1===w()?1:-1;const e=y(t);return e>=1<<t-1?e:e+(-1<<t)+1}let k,B=0,A=0,I=0;function v(t,e,n,s,i){const r=n%f;I=(n/f|0)*t.v+s;const o=r*t.h+i;e(t,wt(t,I,o))}function P(t,e,n){I=n/t.blocksPerLine|0;const s=n%t.blocksPerLine;e(t,wt(t,I,s))}const C=s.length;let D,S,_,T,L,R;R=u?0===r?0===c?function(t,e){const n=b(t.huffmanTableDC),s=0===n?0:x(n)<<l;t.blockData[e]=t.pred+=s}:function(t,e){t.blockData[e]|=w()<<l}:0===c?function(t,e){if(B>0)return void B--;let n=r;const s=o;for(;n<=s;){const s=b(t.huffmanTableAC),i=15&s,r=s>>4;if(0===i){if(r<15){B=y(r)+(1<<r)-1;break}n+=16;continue}n+=r;const o=at[n];t.blockData[e+o]=x(i)*(1<<l),n++}}:function(t,e){let n=r;const s=o;let i,a,c=0;for(;n<=s;){const s=e+at[n],r=t.blockData[s]<0?-1:1;switch(A){case 0:if(a=b(t.huffmanTableAC),i=15&a,c=a>>4,0===i)c<15?(B=y(c)+(1<<c),A=4):(c=16,A=1);else{if(1!==i)throw new it("invalid ACn encoding");k=x(i),A=c?2:3}continue;case 1:case 2:t.blockData[s]?t.blockData[s]+=r*(w()<<l):(c--,0===c&&(A=2===A?3:0));break;case 3:t.blockData[s]?t.blockData[s]+=r*(w()<<l):(t.blockData[s]=k<<l,A=0);break;case 4:t.blockData[s]&&(t.blockData[s]+=r*(w()<<l))}n++}4===A&&(B--,0===B&&(A=0))}:function(t,e){const n=b(t.huffmanTableDC),s=0===n?0:x(n);t.blockData[e]=t.pred+=s;let i=1;for(;i<64;){const n=b(t.huffmanTableAC),s=15&n,r=n>>4;if(0===s){if(r<15)break;i+=16;continue}i+=r;const o=at[i];t.blockData[e+o]=x(s),i++}};let F,E=0;const O=1===C?s[0].blocksPerLine*s[0].blocksPerColumn:f*n.mcusPerColumn;let U,q;for(;E<=O;){const n=i?Math.min(O-E,i):O;if(n>0){for(S=0;S<C;S++)s[S].pred=0;if(B=0,1===C)for(D=s[0],L=0;L<n;L++)P(D,R,E),E++;else for(L=0;L<n;L++){for(S=0;S<C;S++)for(D=s[S],U=D.h,q=D.v,_=0;_<q;_++)for(T=0;T<U;T++)v(D,R,E,_,T);E++}}if(g=0,F=kt(t,e),!F)break;if(F.invalid&&(a(F.invalid),e=F.offset),!(F.marker>=65488&&F.marker<=65495))break;e+=2}return e-d}function yt(t,e,n){const s=t.quantizationTable,i=t.blockData;let r,o,a,c,l,h,f,u,d,m,g,p,w,b,y,x,k;if(!s)throw new it("missing required Quantization Table.");for(let t=0;t<64;t+=8)d=i[e+t],m=i[e+t+1],g=i[e+t+2],p=i[e+t+3],w=i[e+t+4],b=i[e+t+5],y=i[e+t+6],x=i[e+t+7],d*=s[t],m|g|p|w|b|y|x?(m*=s[t+1],g*=s[t+2],p*=s[t+3],w*=s[t+4],b*=s[t+5],y*=s[t+6],x*=s[t+7],r=mt*d+128>>8,o=mt*w+128>>8,a=g,c=y,l=gt*(m-x)+128>>8,u=gt*(m+x)+128>>8,h=p<<4,f=b<<4,r=r+o+1>>1,o=r-o,k=a*dt+c*ut+128>>8,a=a*ut-c*dt+128>>8,c=k,l=l+f+1>>1,f=l-f,u=u+h+1>>1,h=u-h,r=r+c+1>>1,c=r-c,o=o+a+1>>1,a=o-a,k=l*ft+u*ht+2048>>12,l=l*ht-u*ft+2048>>12,u=k,k=h*lt+f*ct+2048>>12,h=h*ct-f*lt+2048>>12,f=k,n[t]=r+u,n[t+7]=r-u,n[t+1]=o+f,n[t+6]=o-f,n[t+2]=a+h,n[t+5]=a-h,n[t+3]=c+l,n[t+4]=c-l):(k=mt*d+512>>10,n[t]=k,n[t+1]=k,n[t+2]=k,n[t+3]=k,n[t+4]=k,n[t+5]=k,n[t+6]=k,n[t+7]=k);for(let t=0;t<8;++t)d=n[t],m=n[t+8],g=n[t+16],p=n[t+24],w=n[t+32],b=n[t+40],y=n[t+48],x=n[t+56],m|g|p|w|b|y|x?(r=mt*d+2048>>12,o=mt*w+2048>>12,a=g,c=y,l=gt*(m-x)+2048>>12,u=gt*(m+x)+2048>>12,h=p,f=b,r=4112+(r+o+1>>1),o=r-o,k=a*dt+c*ut+2048>>12,a=a*ut-c*dt+2048>>12,c=k,l=l+f+1>>1,f=l-f,u=u+h+1>>1,h=u-h,r=r+c+1>>1,c=r-c,o=o+a+1>>1,a=o-a,k=l*ft+u*ht+2048>>12,l=l*ht-u*ft+2048>>12,u=k,k=h*lt+f*ct+2048>>12,h=h*ct-f*lt+2048>>12,f=k,d=r+u,x=r-u,m=o+f,y=o-f,g=a+h,b=a-h,p=c+l,w=c-l,d<16?d=0:d>=4080?d=255:d>>=4,m<16?m=0:m>=4080?m=255:m>>=4,g<16?g=0:g>=4080?g=255:g>>=4,p<16?p=0:p>=4080?p=255:p>>=4,w<16?w=0:w>=4080?w=255:w>>=4,b<16?b=0:b>=4080?b=255:b>>=4,y<16?y=0:y>=4080?y=255:y>>=4,x<16?x=0:x>=4080?x=255:x>>=4,i[e+t]=d,i[e+t+8]=m,i[e+t+16]=g,i[e+t+24]=p,i[e+t+32]=w,i[e+t+40]=b,i[e+t+48]=y,i[e+t+56]=x):(k=mt*d+8192>>14,k=k<-2040?0:k>=2024?255:k+2056>>4,i[e+t]=k,i[e+t+8]=k,i[e+t+16]=k,i[e+t+24]=k,i[e+t+32]=k,i[e+t+40]=k,i[e+t+48]=k,i[e+t+56]=k)}function xt(t,e){const n=e.blocksPerLine,s=e.blocksPerColumn,i=new Int16Array(64);for(let t=0;t<s;t++)for(let s=0;s<n;s++)yt(e,wt(e,t,s),i);return e.blockData}function kt(t,e,n=e){const s=t.length-1;let i=n<e?n:e;if(e>=s)return null;const r=p(t,e);if(r>=65472&&r<=65534)return{invalid:null,marker:r,offset:e};let o=p(t,i);for(;!(o>=65472&&o<=65534);){if(++i>=s)return null;o=p(t,i)}return{invalid:r.toString(16),marker:o,offset:i}}function Bt(t){const e=Math.ceil(t.samplesPerLine/8/t.maxH),n=Math.ceil(t.scanLines/8/t.maxV);for(const s of t.components){const i=Math.ceil(Math.ceil(t.samplesPerLine/8)*s.h/t.maxH),r=Math.ceil(Math.ceil(t.scanLines/8)*s.v/t.maxV),o=e*s.h,a=n*s.v*64*(o+1);s.blockData=new Int16Array(a),s.blocksPerLine=i,s.blocksPerColumn=r}t.mcusPerLine=e,t.mcusPerColumn=n}function At(t,e){const n=p(t,e);let s=(e+=2)+n-2;const i=kt(t,s,e);i?.invalid&&(a(i.invalid),s=i.offset);const r=t.subarray(e,s);return{appData:r,oldOffset:e,newOffset:e+r.length}}function It(t,e){const n=p(t,e),s=(e+=2)+n-2,i=kt(t,s,e);return i?.invalid?i.offset:s}class vt{constructor({decodeTransform:t=null,colorTransform:e=-1}={}){this._decodeTransform=t,this._colorTransform=e}static canUseImageDecoder(t,e=-1){let n=null,s=0,i=null,r=p(t,s);if(s+=2,65496!==r)throw new it("SOI not found");r=p(t,s),s+=2;t:for(;65497!==r;){switch(r){case 65505:const{appData:e,oldOffset:o,newOffset:a}=At(t,s);if(s=a,69===e[0]&&120===e[1]&&105===e[2]&&102===e[3]&&0===e[4]&&0===e[5]){if(n)throw new it("Duplicate EXIF-blocks found.");n={exifStart:o+6,exifEnd:a}}r=p(t,s),s+=2;continue;case 65472:case 65473:case 65474:i=t[s+7];break t;case 65535:255!==t[s]&&s--}s=It(t,s),r=p(t,s),s+=2}return 4===i||3===i&&0===e?null:n||{}}parse(t,{dnlScanLines:e=null}={}){let n,s,i=0,r=null,o=null,c=0;const l=[],h=[],f=[];let u=p(t,i);if(i+=2,65496!==u)throw new it("SOI not found");u=p(t,i),i+=2;t:for(;65497!==u;){let d,m,g;switch(u){case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:const{appData:w,newOffset:b}=At(t,i);i=b,65504===u&&74===w[0]&&70===w[1]&&73===w[2]&&70===w[3]&&0===w[4]&&(r={version:{major:w[5],minor:w[6]},densityUnits:w[7],xDensity:w[8]<<8|w[9],yDensity:w[10]<<8|w[11],thumbWidth:w[12],thumbHeight:w[13],thumbData:w.subarray(14,14+3*w[12]*w[13])}),65518===u&&65===w[0]&&100===w[1]&&111===w[2]&&98===w[3]&&101===w[4]&&(o={version:w[5]<<8|w[6],flags0:w[7]<<8|w[8],flags1:w[9]<<8|w[10],transformCode:w[11]});break;case 65499:const y=p(t,i);i+=2;const x=y+i-2;let k;for(;i<x;){const e=t[i++],n=new Uint16Array(64);if(e>>4){if(e>>4!=1)throw new it("DQT - invalid table spec");for(m=0;m<64;m++)k=at[m],n[k]=p(t,i),i+=2}else for(m=0;m<64;m++)k=at[m],n[k]=t[i++];l[15&e]=n}break;case 65472:case 65473:case 65474:if(n)throw new it("Only single frame JPEGs supported");i+=2,n={},n.extended=65473===u,n.progressive=65474===u,n.precision=t[i++];const B=p(t,i);i+=2,n.scanLines=e||B,n.samplesPerLine=p(t,i),i+=2,n.components=[],n.componentIds={};const A=t[i++];let I=0,v=0;for(d=0;d<A;d++){const e=t[i],s=t[i+1]>>4,r=15&t[i+1];I<s&&(I=s),v<r&&(v=r);const o=t[i+2];g=n.components.push({h:s,v:r,quantizationId:o,quantizationTable:null}),n.componentIds[e]=g-1,i+=3}n.maxH=I,n.maxV=v,Bt(n);break;case 65476:const P=p(t,i);for(i+=2,d=2;d<P;){const e=t[i++],n=new Uint8Array(16);let s=0;for(m=0;m<16;m++,i++)s+=n[m]=t[i];const r=new Uint8Array(s);for(m=0;m<s;m++,i++)r[m]=t[i];d+=17+s,(e>>4?h:f)[15&e]=pt(n,r)}break;case 65501:i+=2,s=p(t,i),i+=2;break;case 65498:const C=1==++c&&!e;i+=2;const D=t[i++],S=[];for(d=0;d<D;d++){const e=t[i++],s=n.componentIds[e],r=n.components[s];r.index=e;const o=t[i++];r.huffmanTableDC=f[o>>4],r.huffmanTableAC=h[15&o],S.push(r)}const _=t[i++],T=t[i++],L=t[i++];try{i+=bt(t,i,n,S,s,_,T,L>>4,15&L,C)}catch(e){if(e instanceof rt)return a(e.message),this.parse(t,{dnlScanLines:e.scanLines});if(e instanceof ot){a(e.message);break t}throw e}break;case 65500:i+=4;break;case 65535:255!==t[i]&&i--;break;default:const R=kt(t,i-2,i-3);if(R?.invalid){a(R.invalid),i=R.offset;break}if(!R||i>=t.length-1){a();break t}throw new it("JpegImage.parse - unknown marker: "+u.toString(16))}u=p(t,i),i+=2}if(!n)throw new it("JpegImage.parse - no frame data found.");this.width=n.samplesPerLine,this.height=n.scanLines,this.jfif=r,this.adobe=o,this.components=[];for(const t of n.components){const e=l[t.quantizationId];e&&(t.quantizationTable=e),this.components.push({index:t.index,output:xt(0,t),scaleX:t.h/n.maxH,scaleY:t.v/n.maxV,blocksPerLine:t.blocksPerLine,blocksPerColumn:t.blocksPerColumn})}this.numComponents=this.components.length}_getLinearizedBlockData(t,e,n=!1){const s=this.width/t,i=this.height/e;let r,o,a,c,l,h,f,u,d,m,g,p=0;const w=this.components.length,b=t*e*w,y=new Uint8ClampedArray(b),x=new Uint32Array(t),k=4294967288;let B;for(f=0;f<w;f++){if(r=this.components[f],o=r.scaleX*s,a=r.scaleY*i,p=f,g=r.output,c=r.blocksPerLine+1<<3,o!==B){for(l=0;l<t;l++)u=0|l*o,x[l]=(u&k)<<3|7&u;B=o}for(h=0;h<e;h++)for(u=0|h*a,m=c*(u&k)|(7&u)<<3,l=0;l<t;l++)y[p]=g[m+x[l]],p+=w}let A=this._decodeTransform;if(n||4!==w||A||(A=new Int32Array([-256,255,-256,255,-256,255,-256,255])),A)for(f=0;f<b;)for(u=0,d=0;u<w;u++,f++,d+=2)y[f]=(y[f]*A[d]>>8)+A[d+1];return y}get _isColorConversionNeeded(){return this.adobe?!!this.adobe.transformCode:3===this.numComponents?0!==this._colorTransform&&(82!==this.components[0].index||71!==this.components[1].index||66!==this.components[2].index):1===this._colorTransform}_convertYccToRgb(t){let e,n,s;for(let i=0,r=t.length;i<r;i+=3)e=t[i],n=t[i+1],s=t[i+2],t[i]=e-179.456+1.402*s,t[i+1]=e+135.459-.344*n-.714*s,t[i+2]=e-226.816+1.772*n;return t}_convertYccToRgba(t,e){for(let n=0,s=0,i=t.length;n<i;n+=3,s+=4){const i=t[n],r=t[n+1],o=t[n+2];e[s]=i-179.456+1.402*o,e[s+1]=i+135.459-.344*r-.714*o,e[s+2]=i-226.816+1.772*r,e[s+3]=255}return e}_convertYcckToRgb(t){let e,n,s,i,r=0;for(let o=0,a=t.length;o<a;o+=4)e=t[o],n=t[o+1],s=t[o+2],i=t[o+3],t[r++]=n*(-660635669420364e-19*n+.000437130475926232*s-54080610064599e-18*e+.00048449797120281*i-.154362151871126)-122.67195406894+s*(-.000957964378445773*s+.000817076911346625*e-.00477271405408747*i+1.53380253221734)+e*(.000961250184130688*e-.00266257332283933*i+.48357088451265)+i*(-.000336197177618394*i+.484791561490776),t[r++]=107.268039397724+n*(219927104525741e-19*n-.000640992018297945*s+.000659397001245577*e+.000426105652938837*i-.176491792462875)+s*(-.000778269941513683*s+.00130872261408275*e+.000770482631801132*i-.151051492775562)+e*(.00126935368114843*e-.00265090189010898*i+.25802910206845)+i*(-.000318913117588328*i-.213742400323665),t[r++]=n*(-.000570115196973677*n-263409051004589e-19*s+.0020741088115012*e-.00288260236853442*i+.814272968359295)-20.810012546947+s*(-153496057440975e-19*s-.000132689043961446*e+.000560833691242812*i-.195152027534049)+e*(.00174418132927582*e-.00255243321439347*i+.116935020465145)+i*(-.000343531996510555*i+.24165260232407);return t.subarray(0,r)}_convertYcckToRgba(t){for(let e=0,n=t.length;e<n;e+=4){const n=t[e],s=t[e+1],i=t[e+2],r=t[e+3];t[e]=s*(-660635669420364e-19*s+.000437130475926232*i-54080610064599e-18*n+.00048449797120281*r-.154362151871126)-122.67195406894+i*(-.000957964378445773*i+.000817076911346625*n-.00477271405408747*r+1.53380253221734)+n*(.000961250184130688*n-.00266257332283933*r+.48357088451265)+r*(-.000336197177618394*r+.484791561490776),t[e+1]=107.268039397724+s*(219927104525741e-19*s-.000640992018297945*i+.000659397001245577*n+.000426105652938837*r-.176491792462875)+i*(-.000778269941513683*i+.00130872261408275*n+.000770482631801132*r-.151051492775562)+n*(.00126935368114843*n-.00265090189010898*r+.25802910206845)+r*(-.000318913117588328*r-.213742400323665),t[e+2]=s*(-.000570115196973677*s-263409051004589e-19*i+.0020741088115012*n-.00288260236853442*r+.814272968359295)-20.810012546947+i*(-153496057440975e-19*i-.000132689043961446*n+.000560833691242812*r-.195152027534049)+n*(.00174418132927582*n-.00255243321439347*r+.116935020465145)+r*(-.000343531996510555*r+.24165260232407),t[e+3]=255}return t}_convertYcckToCmyk(t){let e,n,s;for(let i=0,r=t.length;i<r;i+=4)e=t[i],n=t[i+1],s=t[i+2],t[i]=434.456-e-1.402*s,t[i+1]=119.541-e+.344*n+.714*s,t[i+2]=481.816-e-1.772*n;return t}_convertCmykToRgb(t){let e,n,s,i,r=0;for(let o=0,a=t.length;o<a;o+=4)e=t[o],n=t[o+1],s=t[o+2],i=t[o+3],t[r++]=255+e*(-6747147073602441e-20*e+.0008379262121013727*n+.0002894718188643294*s+.003264231057537806*i-1.1185611867203937)+n*(26374107616089405e-21*n-8626949158638572e-20*s-.0002748769067499491*i-.02155688794978967)+s*(-3878099212869363e-20*s-.0003267808279485286*i+.0686742238595345)-i*(.0003361971776183937*i+.7430659151342254),t[r++]=255+e*(.00013596372813588848*e+.000924537132573585*n+.00010567359618683593*s+.0004791864687436512*i-.3109689587515875)+n*(-.00023545346108370344*n+.0002702845253534714*s+.0020200308977307156*i-.7488052167015494)+s*(6834815998235662e-20*s+.00015168452363460973*i-.09751927774728933)-i*(.0003189131175883281*i+.7364883807733168),t[r++]=255+e*(13598650411385307e-21*e+.00012423956175490851*n+.0004751985097583589*s-36729317476630422e-22*i-.05562186980264034)+n*(.00016141380598724676*n+.0009692239130725186*s+.0007782692450036253*i-.44015232367526463)+s*(5.068882914068769e-7*s+.0017778369011375071*i-.7591454649749609)-i*(.0003435319965105553*i+.7063770186160144);return t.subarray(0,r)}_convertCmykToRgba(t){for(let e=0,n=t.length;e<n;e+=4){const n=t[e],s=t[e+1],i=t[e+2],r=t[e+3];t[e]=255+n*(-6747147073602441e-20*n+.0008379262121013727*s+.0002894718188643294*i+.003264231057537806*r-1.1185611867203937)+s*(26374107616089405e-21*s-8626949158638572e-20*i-.0002748769067499491*r-.02155688794978967)+i*(-3878099212869363e-20*i-.0003267808279485286*r+.0686742238595345)-r*(.0003361971776183937*r+.7430659151342254),t[e+1]=255+n*(.00013596372813588848*n+.000924537132573585*s+.00010567359618683593*i+.0004791864687436512*r-.3109689587515875)+s*(-.00023545346108370344*s+.0002702845253534714*i+.0020200308977307156*r-.7488052167015494)+i*(6834815998235662e-20*i+.00015168452363460973*r-.09751927774728933)-r*(.0003189131175883281*r+.7364883807733168),t[e+2]=255+n*(13598650411385307e-21*n+.00012423956175490851*s+.0004751985097583589*i-36729317476630422e-22*r-.05562186980264034)+s*(.00016141380598724676*s+.0009692239130725186*i+.0007782692450036253*r-.44015232367526463)+i*(5.068882914068769e-7*i+.0017778369011375071*r-.7591454649749609)-r*(.0003435319965105553*r+.7063770186160144),t[e+3]=255}return t}getData({width:t,height:e,forceRGBA:n=!1,forceRGB:s=!1,isSourcePDF:i=!1}){if(this.numComponents>4)throw new it("Unsupported color mode");const r=this._getLinearizedBlockData(t,e,i);if(1===this.numComponents&&(n||s)){const t=r.length*(n?4:3),e=new Uint8ClampedArray(t);let s=0;if(n)!function(t,e){if(u.isLittleEndian)for(let n=0,s=t.length;n<s;n++)e[n]=65793*t[n]|4278190080;else for(let n=0,s=t.length;n<s;n++)e[n]=16843008*t[n]|255}(r,new Uint32Array(e.buffer));else for(const t of r)e[s++]=t,e[s++]=t,e[s++]=t;return e}if(3===this.numComponents&&this._isColorConversionNeeded){if(n){const t=new Uint8ClampedArray(r.length/3*4);return this._convertYccToRgba(r,t)}return this._convertYccToRgb(r)}if(4===this.numComponents){if(this._isColorConversionNeeded)return n?this._convertYcckToRgba(r):s?this._convertYcckToRgb(r):this._convertYcckToCmyk(r);if(n)return this._convertCmykToRgba(r);if(s)return this._convertCmykToRgb(r)}return r}}var Pt,Ct=(Pt="undefined"!=typeof document?document.currentScript?.src:void 0,async function(t={}){var e,n,s,i=t,r=new Promise(((t,s)=>{e=t,n=s})),o=Object.assign({},i),a="./this.program",c=(t,e)=>{throw e},l="";"undefined"!=typeof document&&document.currentScript&&(l=document.currentScript.src),Pt&&(l=Pt),l=l.startsWith("blob:")?"":l.slice(0,l.replace(/[?#].*/,"").lastIndexOf("/")+1),s=async t=>{var e=await fetch(t,{credentials:"same-origin"});if(e.ok)return e.arrayBuffer();throw new Error(e.status+" : "+e.url)};var h=i.print||function(){}.bind(),f=i.printErr||function(){}.bind();Object.assign(i,o),o=null,i.arguments&&i.arguments,i.thisProgram&&(a=i.thisProgram);var u,d,m,g,p,w,b=i.wasmBinary,y=!1;function x(){var t=u.buffer;i.HEAP8=m=new Int8Array(t),i.HEAP16=new Int16Array(t),i.HEAPU8=g=new Uint8Array(t),i.HEAPU16=new Uint16Array(t),i.HEAP32=p=new Int32Array(t),i.HEAPU32=w=new Uint32Array(t),i.HEAPF32=new Float32Array(t),i.HEAPF64=new Float64Array(t),i.HEAP64=new BigInt64Array(t),i.HEAPU64=new BigUint64Array(t)}var k,B=0,A=null;function I(t){i.onAbort?.(t),f(t="Aborted("+t+")"),y=!0,t+=". Build with -sASSERTIONS for more info.";var e=new WebAssembly.RuntimeError(t);throw n(e),e}async function v(t){if(!b)try{var e=await s(t);return new Uint8Array(e)}catch{}return function(t){if(t==k&&b)return new Uint8Array(b);throw"both async and sync fetching of the wasm failed"}(t)}class P{name="ExitStatus";constructor(t){this.message=`Program terminated with exit(${t})`,this.status=t}}var C=t=>{for(;t.length>0;)t.shift()(i)},D=[],S=t=>D.unshift(t),_=[],T=t=>_.unshift(t),L=i.noExitRuntime||!0,R=0,F={},E=t=>{if(t instanceof P||"unwind"==t)return d;c(0,t)},O=()=>L||R>0,U=t=>{d=t,O()||(i.onExit?.(t),y=!0),c(0,new P(t))},q=t=>{if(!y)try{t(),(()=>{if(!O())try{(t=>{d=t,U(t)})(d)}catch(t){E(t)}})()}catch(t){E(t)}},H=t=>{var e=(t-u.buffer.byteLength+65535)/65536|0;try{return u.grow(e),x(),1}catch(t){}},N={},W=()=>{if(!W.strings){var t={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:("object"==typeof navigator&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:a||"./this.program"};for(var e in N)void 0===N[e]?delete t[e]:t[e]=N[e];var n=[];for(var e in t)n.push(`${e}=${t[e]}`);W.strings=n}return W.strings},M=[null,[],[]],J="undefined"!=typeof TextDecoder?new TextDecoder:void 0,j=(t,e=0,n=NaN)=>{for(var s=e+n,i=e;t[i]&&!(i>=s);)++i;if(i-e>16&&t.buffer&&J)return J.decode(t.subarray(e,i));for(var r="";e<i;){var o=t[e++];if(128&o){var a=63&t[e++];if(192!=(224&o)){var c=63&t[e++];if((o=224==(240&o)?(15&o)<<12|a<<6|c:(7&o)<<18|a<<12|c<<6|63&t[e++])<65536)r+=String.fromCharCode(o);else{var l=o-65536;r+=String.fromCharCode(55296|l>>10,56320|1023&l)}}else r+=String.fromCharCode((31&o)<<6|a)}else r+=String.fromCharCode(o)}return r},G=(t,e)=>{var n=M[t];0===e||10===e?((1===t?h:f)(j(n)),n.length=0):n.push(e)},V=(t,e)=>t?j(g,t,e):"",z={l:()=>I(""),k:()=>{L=!1,R=0},m:(t,e)=>{if(F[t]&&(clearTimeout(F[t].id),delete F[t]),!e)return 0;var n=setTimeout((()=>{delete F[t],q((()=>$(t,performance.now())))}),e);return F[t]={id:n,timeout_ms:e},0},g:function(t,e){t>>=2;const n=i.imageData=new Uint8ClampedArray(e),s=p.subarray(t,t+e);n.set(s)},f:function(t,e,n,s){t>>=2,e>>=2,n>>=2;const r=i.imageData=new Uint8ClampedArray(3*s),o=p.subarray(t,t+s),a=p.subarray(e,e+s),c=p.subarray(n,n+s);for(let t=0;t<s;t++)r[3*t]=o[t],r[3*t+1]=a[t],r[3*t+2]=c[t]},e:function(t,e,n,s,r){t>>=2,e>>=2,n>>=2,s>>=2;const o=i.imageData=new Uint8ClampedArray(4*r),a=p.subarray(t,t+r),c=p.subarray(e,e+r),l=p.subarray(n,n+r),h=p.subarray(s,s+r);for(let t=0;t<r;t++)o[4*t]=a[t],o[4*t+1]=c[t],o[4*t+2]=l[t],o[4*t+3]=h[t]},n:t=>{var e,n=g.length,s=2147483648;if((t>>>=0)>s)return!1;for(var i=1;i<=4;i*=2){var r=n*(1+.2/i);r=Math.min(r,t+100663296);var o=Math.min(s,(e=Math.max(t,r),65536*Math.ceil(e/65536)));if(H(o))return!0}return!1},p:(t,e)=>{var n=0;return W().forEach(((s,i)=>{var r=e+n;w[t+4*i>>2]=r,((t,e)=>{for(var n=0;n<t.length;++n)m[e++]=t.charCodeAt(n);m[e]=0})(s,r),n+=s.length+1})),0},q:(t,e)=>{var n=W();w[t>>2]=n.length;var s=0;return n.forEach((t=>s+=t.length+1)),w[e>>2]=s,0},b:t=>52,o:function(t,e,n,s){var i;return e=(i=e)<-9007199254740992||i>9007199254740992?NaN:Number(i),70},c:(t,e,n,s)=>{for(var i=0,r=0;r<n;r++){var o=w[e>>2],a=w[e+4>>2];e+=8;for(var c=0;c<a;c++)G(t,g[o+c]);i+=a}return w[s>>2]=i,0},r:function(t,e){t>>=2;const n=i.imageData=new Uint8ClampedArray(4*e),s=p.subarray(t,t+e);for(let t=0;t<e;t++)n[4*t]=n[4*t+1]=n[4*t+2]=s[t],n[4*t+3]=255},i:function(t,e,n){t>>=2,e>>=2;const s=i.imageData=new Uint8ClampedArray(4*n),r=p.subarray(t,t+n),o=p.subarray(e,e+n);for(let t=0;t<n;t++)s[4*t]=s[4*t+1]=s[4*t+2]=r[t],s[4*t+3]=o[t]},d:function(t){const e=V(t);(i.warn||console.warn)(`OpenJPEG: ${e}`)},j:U,h:function(t,e,n,s){t>>=2,e>>=2,n>>=2;const r=i.imageData=new Uint8ClampedArray(4*s),o=p.subarray(t,t+s),a=p.subarray(e,e+s),c=p.subarray(n,n+s);for(let t=0;t<s;t++)r[4*t]=o[t],r[4*t+1]=a[t],r[4*t+2]=c[t],r[4*t+3]=255},a:function(t){const e=V(t);i.errorMessages?i.errorMessages+="\n"+e:i.errorMessages=e}},Y=await async function(){function t(t,e){return Y=t.exports,u=Y.s,x(),function(){if(B--,i.monitorRunDependencies?.(B),0==B&&A){var t=A;A=null,t()}}(),Y}B++,i.monitorRunDependencies?.(B);var e={a:z};if(i.instantiateWasm)return new Promise(((n,s)=>{i.instantiateWasm(e,((e,s)=>{t(e),n(e.exports)}))}));k??=function(t){return i.locateFile?i.locateFile(t,l):l+t}("openjpeg.wasm");try{var s=function(e){return t(e.instance)}(await async function(t,e,n){if(!t&&"function"==typeof WebAssembly.instantiateStreaming)try{var s=fetch(e,{credentials:"same-origin"});return await WebAssembly.instantiateStreaming(s,n)}catch(t){f(`wasm streaming compile failed: ${t}`),f("falling back to ArrayBuffer instantiation")}return async function(t,e){try{var n=await v(t);return await WebAssembly.instantiate(n,e)}catch(t){f(`failed to asynchronously prepare wasm: ${t}`),I(t)}}(e,n)}(b,k,e));return s}catch(e){return n(e),Promise.reject(e)}}(),$=(Y.t,i._malloc=Y.u,i._free=Y.v,i._jp2_decode=Y.x,Y.y);if(i.preInit)for("function"==typeof i.preInit&&(i.preInit=[i.preInit]);i.preInit.length>0;)i.preInit.pop()();return function t(){function n(){i.calledRun=!0,y||(Y.t(),e(i),i.onRuntimeInitialized?.(),function(){if(i.postRun)for("function"==typeof i.postRun&&(i.postRun=[i.postRun]);i.postRun.length;)S(i.postRun.shift());C(D)}())}B>0?A=t:(!function(){if(i.preRun)for("function"==typeof i.preRun&&(i.preRun=[i.preRun]);i.preRun.length;)T(i.preRun.shift());C(_)}(),B>0?A=t:i.setStatus?(i.setStatus("Running..."),setTimeout((()=>{setTimeout((()=>i.setStatus("")),1),n()}),1)):n())}(),r});const Dt=Ct;class St extends d{constructor(t,e,n,s){super(),this.bytes=t instanceof Uint8Array?t:new Uint8Array(t),this.start=e||0,this.pos=this.start,this.end=e+n||this.bytes.length,this.dict=s}get length(){return this.end-this.start}get isEmpty(){return 0===this.length}getByte(){return this.pos>=this.end?-1:this.bytes[this.pos++]}getBytes(t){const e=this.bytes,n=this.pos,s=this.end;if(!t)return e.subarray(n,s);let i=n+t;return i>s&&(i=s),this.pos=i,e.subarray(n,i)}getByteRange(t,e){return t<0&&(t=0),e>this.end&&(e=this.end),this.bytes.subarray(t,e)}reset(){this.pos=this.start}moveStart(){this.start=this.pos}makeSubStream(t,e,n=null){return new St(this.bytes.buffer,t,e,n)}}class _t extends h{constructor(t){super(t,"JpxError")}}class Tt{static#t=null;static#e=null;static#n=null;static#s=!0;static#i=!0;static#r=null;static#o=null;static#a=null;static setOptions({handler:t,useWasm:e,useWorkerFetch:n,wasmUrl:s,wasmAbsoluteUrl:i,wasmFallback:r}){this.#s=e,this.#i=n,this.#r=s,this.#o=i,this.#a=r,n||(this.#e=t)}static async#c(t){let e=`${this.#r}openjpeg_nowasm_fallback.js`,n=null;try{n=(await import(e)).default()}catch(t){a(),this.#a&&(n=this.#a)}t(n)}static async#l(t,e,n){const s="openjpeg.wasm";try{return this.#t||(this.#i?this.#t=await async function(t){const e=await fetch(t);if(!e.ok)throw new Error(`Failed to fetch file "${t}" with "${e.statusText}".`);return new Uint8Array(await e.arrayBuffer())}(`${this.#r}${s}`):this.#t=await this.#e.sendWithPromise("FetchBinaryData",{type:"wasmFactory",filename:s})),n((await WebAssembly.instantiate(this.#t,e)).instance)}catch(e){return a(),this.#c(t),null}finally{this.#e=null}}static async decode(t,{numComponents:e=4,isIndexedColormap:n=!1,smaskInData:s=!1}={}){if(!this.#n){const{promise:t,resolve:e}=Promise.withResolvers(),n=[t];this.#s?n.push(Dt({warn:a,instantiateWasm:this.#l.bind(this,e)})):this.#c(e),this.#n=Promise.race(n)}const i=await this.#n;if(!i)throw new _t("OpenJPEG failed to initialize");let r;try{const o=t.length;if(r=i._malloc(o),i.HEAPU8.set(t,r),i._jp2_decode(r,o,e>0?e:0,!!n,!!s)){const{errorMessages:t}=i;if(t)throw delete i.errorMessages,new _t(t);throw new _t("Unknown error")}const{imageData:a}=i;return i.imageData=null,a}finally{r&&i._free(r)}}static cleanup(){this.#n=null}static parseImageProperties(t){if(!(t instanceof ArrayBuffer||ArrayBuffer.isView(t)))throw new _t("Invalid data format, must be a TypedArray.");let e=(t=new St(t)).getByte();for(;e>=0;){const n=e;if(e=t.getByte(),65361==(n<<8|e)){t.skip(4);const e=t.getInt32()>>>0,n=t.getInt32()>>>0,s=t.getInt32()>>>0,i=t.getInt32()>>>0;return t.skip(16),{width:e-s,height:n-i,bitsPerComponent:8,componentsCount:t.getUint16()}}}throw new _t("No size marker found in JPX stream")}}var Lt=e.Jbig2Error,Rt=e.Jbig2Image,Ft=e.JpegError,Et=e.JpegImage,Ot=e.JpxError,Ut=e.JpxImage,qt=e.VerbosityLevel,Ht=e.getVerbosityLevel,Nt=e.setVerbosityLevel;export{Lt as Jbig2Error,Rt as Jbig2Image,Ft as JpegError,Et as JpegImage,Ot as JpxError,Ut as JpxImage,qt as VerbosityLevel,Ht as getVerbosityLevel,Nt as setVerbosityLevel};